<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Radiesth√©sie ‚Äì Corps √©nerg√©tique</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #e7dfd3;
}

.layout {
  display: flex;
  height: 100vh;
}

.sidebar {
  width: 300px;
  background: #f4efe6;
  padding: 15px;
  overflow-y: auto;
  border-right: 1px solid #ccc;
}

.viewer {
  flex: 1;
  background: #111;
}

#viewer3D {
  width: 100%;
  height: 100%;
}

/* MENU */
.tree-menu {
  list-style: none;
  padding: 0;
  margin: 0;
}

.tree-menu > li {
  padding: 10px;
  cursor: pointer;
  border-bottom: 1px solid #ddd;
  font-weight: bold;
}

.tree-menu li:hover {
  background: #e0d8cc;
}

.submenu {
  list-style: none;
  padding-left: 15px;
  margin-top: 5px;
  display: none;
}

.tree-menu li.open > .submenu {
  display: block;
}

.submenu li {
  padding: 6px 0;
  font-weight: normal;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="layout">

  <!-- MENU -->
  <aside class="sidebar">
    <h3>Soins √©nerg√©tiques</h3>

    <ul class="tree-menu">
      <li class="has-submenu">
        Chakras
        <ul class="submenu">
          <li data-target="chakra-racine">Chakra racine</li>
          <li data-target="chakra-coeur">Chakra c≈ìur</li>
          <li data-target="chakra-couronne">Chakra couronne</li>
        </ul>
      </li>

      <li class="has-submenu">
        M√©ridiens
        <ul class="submenu">
          <li data-target="meridien-poumon">Poumon</li>
          <li data-target="meridien-coeur">C≈ìur</li>
        </ul>
      </li>
    </ul>
  </aside>

  <!-- VIEWER -->
  <main class="viewer">
    <div id="viewer3D"></div>
  </main>

</div>

<!-- THREE.JS -->
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/loaders/GLTFLoader.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ================= MENU ================= */
  document.querySelectorAll(".has-submenu").forEach(item => {
    item.addEventListener("click", e => {
      if (e.target === item) {
        item.classList.toggle("open");
      }
    });
  });

  /* ================= THREE ================= */
  let scene, camera, renderer, controls, model;
  const highlightColor = new THREE.Color(0xff5555);
  const defaultColor = new THREE.Color(0xffffff);

  const container = document.getElementById("viewer3D");

  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x111111);

  camera = new THREE.PerspectiveCamera(
    45,
    container.clientWidth / container.clientHeight,
    0.1,
    1000
  );
  camera.position.set(0, 1.6, 3);

  renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(container.clientWidth, container.clientHeight);
  container.appendChild(renderer.domElement);

  controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;

  scene.add(new THREE.AmbientLight(0xffffff, 0.6));
  const light = new THREE.DirectionalLight(0xffffff, 0.8);
  light.position.set(5, 10, 7);
  scene.add(light);

  const loader = new THREE.GLTFLoader();
const loader = new THREE.GLTFLoader();
loader.load(
  "models/corps_humain.glb",
  gltf => {
    model = gltf.scene;

    // üîß MAT√âRIAUX visibles
    model.traverse(o => {
      if (o.isMesh) {
        o.material = new THREE.MeshStandardMaterial({
          color: 0xeaeaea,
          roughness: 0.4,
          metalness: 0.0
        });
        o.castShadow = true;
        o.receiveShadow = true;
      }
    });

    // üìê CALCUL DU CENTRE (ACUMASTER)
    const box = new THREE.Box3().setFromObject(model);
    const center = box.getCenter(new THREE.Vector3());
    const size = box.getSize(new THREE.Vector3());

    // üéØ RECENTRAGE
    model.position.sub(center);

    // üìè MISE √Ä L‚Äô√âCHELLE
    const maxDim = Math.max(size.x, size.y, size.z);
    const scale = 1.8 / maxDim;
    model.scale.setScalar(scale);

    scene.add(model);

    // üé• CAM√âRA FORC√âE SUR LE CORPS
    camera.position.set(0, 1.6, 3);
    camera.lookAt(0, 1, 0);
    controls.target.set(0, 1, 0);
    controls.update();
  },
  undefined,
  err => console.error("Erreur chargement mod√®le :", err)
);


  function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  window.addEventListener("resize", () => {
    camera.aspect = container.clientWidth / container.clientHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(container.clientWidth, container.clientHeight);
  });

  /* ====== HIGHLIGHT ====== */
  document.querySelectorAll("[data-target]").forEach(item => {
    item.addEventListener("click", e => {
      e.stopPropagation();
      if (!model) return;

      model.traverse(o => {
        if (o.isMesh) {
          o.material.color.copy(
            o.name === item.dataset.target ? highlightColor : defaultColor
          );
        }
      });
    });
  });

});
</script>

</body>
</html>
